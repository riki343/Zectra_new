{% extends '@Zectranet/index.html.twig' %}

{% block title %}{{ office.name }}{% endblock %}

{% block body %}

    <div class="row">
        <ol class="breadcrumb" style="margin: 0 -30px; border-radius:0 !important; padding: 12px 50px; background-color: #fbfbfb; ">
            <li class="active">
                Home Office
            </li>
        </ol>
    </div>

    <div class="page-header">
        <div class="row">
            <div class="col-md-12">
                <span style="font-size: 30px; font-family: 'PT Sans Narrow', sans-serif; font-weight: bold;">
                    {{ office.name }}
                </span>
            </div>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4">
            <ul class="list-group" style="box-shadow: 2px 3px 6px 0 darkkhaki;">
                <li class="list-group-item active" style="background:#ddedf4; color:#606060;">
                    <b>Create Project</b>
                </li>
                <li class="list-group-item">
                    <form action="{{ path('zectranet_add_project', { 'office_id': office.id } ) }}" method="post">
                        <p>
                            <label style="width: 100%;">
                                Project name:
                                <input class="form-control" name="name" type="text"/>
                            </label>
                        </p>
                        <p>
                            <label style="width: 100%;">
                                Project template:
                                <select class="form-control" name="type">
                                    <option value="1" selected>QnA Forum(not working yet)</option>
                                    <option value="2">Header forum</option>
                                    <option value="3">Trading office(not working yet)</option>
                                    <option value="4">Development(not working yet)</option>
                                </select>
                            </label>
                        </p>
                        <hr/>
                        <p align="right">
                            <button class="btn btn-default">Create</button>
                        </p>
                    </form>
                </li>
            </ul>
        </div>
        <div class="col-md-4 col-md-offset-4">
            <ul class="list-group"  style="box-shadow: 2px 3px 6px 0 darkkhaki;">
                <li class="list-group-item active" style="background:#ddedf4; color:#606060;">
                    <b>Market Place</b>
                </li>
                <li class="list-group-item">
                    <a class="btn btn-default" href="{{ path('zectranet_public_market') }}">Market Place</a>
                </li>
            </ul>
        </div>
    </div>

    <div class="row">
        <div class="col-md-4">
            <ul class="list-group" style="box-shadow: 2px 3px 6px 0 darkkhaki; height: 427px; overflow-y: auto;">
                <li class="list-group-item active"  style="background:#ddedf4; color:#606060;">
                    <b>Contact list</b>
                </li>
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-xs-3">
                            <img class="img-responsive img-circle" src="{{ asset('') ~ 'documents/' ~ app.user.avatar }}" alt="avatar"/>
                        </div>
                        <div class="col-xs-9">
                            <p>{{ app.user.username }}</p>
                        </div>
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-xs-3">
                            <img class="img-responsive img-circle" src="{{ asset('') ~ 'documents/' ~ app.user.avatar }}" alt="avatar"/>
                        </div>
                        <div class="col-xs-9">
                            <p>{{ app.user.username }}</p>
                        </div>
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-xs-3">
                            <img class="img-responsive img-circle" src="{{ asset('') ~ 'documents/' ~ app.user.avatar }}" alt="avatar"/>
                        </div>
                        <div class="col-xs-9">
                            <p>{{ app.user.username }}</p>
                        </div>
                    </div>
                </li>
                <li class="list-group-item">
                    <div class="row">
                        <div class="col-xs-3">
                            <img class="img-responsive img-circle" src="{{ asset('') ~ 'documents/' ~ app.user.avatar }}" alt="avatar"/>
                        </div>
                        <div class="col-xs-9">
                            <p>{{ app.user.username }}</p>
                        </div>
                    </div>
                </li>
            </ul>
        </div>

        <div class="col-md-8">
            <div ng-controller="DocumentsController">
                <div class="chat-panel list-group" ng-controller="ChatController" ng-init="getPosts(0, 100)" style="box-shadow: 2px 3px 6px 0 darkkhaki;">
                    <div class="list-group-item active" style="background:#ddedf4; color:#606060;">
                        <i class="fa fa-comments fa-fw"></i>
                        <strong>Office Chat</strong>
                    </div>
                    <div id="posts-panel" class="list-group-item panel-body" style="max-height: 300px;">
                        {% if office.postsOffice | length == 0 %}
                            <h4 class="text-info text-center vertical-center">Posts will be displayed here</h4>
                        {% endif %}
                        <ul class="chat">
                            <li ng-repeat="post in posts" highlight style="border-bottom: none;"  class="clearfix" ng-class="{'right': {{ app.user.id }} == post.user.id, 'left': {{ app.user.id }} != post.user.id }">
                    <span class="chat-img"
                          ng-class="{'pull-right': {{ app.user.id }} == post.user.id, 'pull-left': {{ app.user.id }} != post.user.id }"
                          ng-init="avatar = generateAsset('{{ asset('') }}', 'documents/' + post.user.avatar)">
                            <img src="#" ng-src="[[avatar]]" alt="User Avatar" class="img-circle" style="width: 50px; height: 50px;"/>
                    </span>
                                <div class="chat-body clearfix">
                                    <div class="header" style="height: 28px;">
                                        <strong class="primary-font"
                                                ng-class="{'pull-right': {{ app.user.id }} == post.user.id, 'pull-left': {{ app.user.id }} != post.user.id }">
                                            [[post.user.name + ' ' + post.user.surname + ' (' + post.user.username + ')' ]]
                                        </strong>

                                        <small class="text-muted" ng-class="{'pull-left': {{ app.user.id }} == post.user.id, 'pull-right': {{ app.user.id }} != post.user.id }">
                                            <i class="fa fa-clock-o fa-fw"></i>
                                            Posted on <span style="color: #000000; font-style: italic">[[post.posted]]</span>
                                            <i ng-if="post.edited" class="fa fa-edit"></i>
                                        </small>
                                    </div>
                        <pre style="white-space: pre-line;">
                            <span ng-bind-html="post.message"></span>
                        </pre>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <div class="list-group-item">
                        <form class="input-group input-group-lg">
                <span class="input-group-btn">
                    <button class="btn btn-default" type="button" style="height: 65px;" data-placement="top" id="add_dialog_btn"  data-toggle="modal" data-target="#add_dialog">
                        <i class="fa fa-file"></i>
                    </button>
                </span>
                            <textarea id="textarea-post"  name="message" class="form-control" rows="3" style="font-size: 11px; height: 65px;" ng-model="message"></textarea>
                <span class="input-group-btn">
                    <button class="btn btn-primary" name="subscribe" type="button" style="height: 65px; font-size:15px;" ng-click="SendPost(message)">
                        <span>Post</span>
                    </button>
                </span>
                        </form>
                        <div id="slide-down-menu-screenshots" cg-busy="documentPromise" style="display: none;">
                            <div id="div-screenshot" style="display: none; width: auto;height: auto;">
                                <ng-include src="{{ '\'' ~ asset('bundles/zectranet/templates/attachments.html') ~ '\'' }}"></ng-include>
                            </div>
                        </div>
                    </div>
                </div>
                {% include '@Zectranet/dialogAdd.html.twig' %}
            </div>
        </div>
    </div>

{% endblock %}

{% block modals %}
    {{ parent() }}
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script>
        var getDocuments_;
        JSON_URLS.documentsGet = "{{ path('zectranet_document_get') }}";
        JSON_URLS.addPost = "{{ path('zectranet_office_add_post', { 'office_id': office.id }) }}";
        JSON_URLS.getPosts = "{{ path('zectranet_office_get_post', { 'office_id': office.id }) }}";
        JSON_URLS.InsertScreenshotsInPHP = "{{ path('zectranet_InsertScreenshotsInPHP') }}";
    </script>
    <script src="{{ asset('bundles/zectranet/js/custom/chatController.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/custom/documentsController.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/custom/officeController.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/upload/jquery.knob.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/upload/jquery.ui.widget.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/upload/jquery.iframe-transport.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/upload/jquery.fileupload.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/zectranet/js/upload/script.js') }}" type="text/javascript"></script>

{% endblock %}